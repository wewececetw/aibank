<html>
      <head>
        <meta charset="UTF-8">
        <title>04-05-Autofilter-Expressions-Topten.md</title>
      </head>
      <body>
        <h1 id="phpexcel-autofilter-reference">PHPExcel AutoFilter Reference</h1>
<h2 id="autofilter-expressions">Autofilter Expressions</h2>
<h3 id="top-ten-filters">Top Ten Filters</h3>
<p>Top Ten Filters are similar to Dynamic Filters in that they are based on a summarisation of the actual data values in the cells. However, unlike Dynamic Filters where you can only select a single option, Top Ten Filters allow you to select based on a number of criteria:</p>
<p><img src="./images/04-05-topten-autofilter-1.png" alt="04-05-custom-topten-1.png"></p>
<p><img src="./images/04-05-topten-autofilter-2.png" alt="04-05-custom-topten-2.png"></p>
<p>You can identify whether you want the top (highest) or bottom (lowest) values.You can identify how many values you wish to select in the filterYou can identify whether this should be a percentage or a number of items.</p>
<p>Like Dynamic Filters, only a single Top Ten filter can be applied to a column at a time.</p>
<p>We start by specifying a Filter type, this time a DYNAMICFILTER.</p>
<pre><code class="lang-php">$columnFilter-&gt;setFilterType(
    PHPExcel_Worksheet_AutoFilter_Column::AUTOFILTER_FILTERTYPE_TOPTENFILTER
);
</code></pre>
<p>Then we create the rule:</p>
<pre><code class="lang-php">$columnFilter-&gt;createRule()
    -&gt;setRule(
        PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_COLUMN_RULE_TOPTEN_PERCENT,
        5,
        PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_COLUMN_RULE_TOPTEN_TOP
    )
    -&gt;setRuleType(
        PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_RULETYPE_TOPTENFILTER
    );
</code></pre>
<p>This will filter the Top 5 percent of values in the column.</p>
<p>To specify the lowest (bottom 2 values), we would specify a rule of:</p>
<pre><code class="lang-php">$columnFilter-&gt;createRule()
    -&gt;setRule(
        PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_COLUMN_RULE_TOPTEN_BY_VALUE,
        5,
        PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_COLUMN_RULE_TOPTEN_BOTTOM
    )
    -&gt;setRuleType(
        PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_RULETYPE_TOPTENFILTER
    );
</code></pre>
<p>The option values for TopTen Filters top/bottom value/percent are all defined in the PHPExcel_Worksheet_AutoFilter_Column_Rule class, and comprise:</p>
<pre><code>Operator Constant                      | Value       |
---------------------------------------|-------------|
AUTOFILTER_COLUMN_RULE_TOPTEN_BY_VALUE | &#39;byValue&#39;   |
AUTOFILTER_COLUMN_RULE_TOPTEN_PERCENT  | &#39;byPercent&#39; |
</code></pre><p>and</p>
<pre><code>Operator Constant                    | Value    |
-------------------------------------|----------|
AUTOFILTER_COLUMN_RULE_TOPTEN_TOP    | &#39;top&#39;    |
AUTOFILTER_COLUMN_RULE_TOPTEN_BOTTOM | &#39;bottom&#39; |
</code></pre>
      </body>
    </html>